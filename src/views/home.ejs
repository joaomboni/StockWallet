<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Fundamentus Clone</title>
    <link rel="stylesheet" href="../public/styles/style.css">
</head>
<body>

<header>
    <div class="logo">
        <h1><span>FUNDA</span>MENTUS</h1>
        <p>INVISTA CONSCIENTE</p>
    </div>

    <div class="search-box">
        <form id="formBusca">
            <input id="symbolInput" type="text" placeholder="Procurar por a√ß√£o/empresa">
            <button type="submit">EXIBIR</button>
        </form>
    </div>
</header>

<nav>
    <a class="active" href="#">P√ÅGINA INICIAL</a>
    <a href="#">INVESTIMENTO CONSCIENTE</a>
    <div class="dropdown">
        <button class="dropbtn">MAIS OP√á√ïES ‚ñº</button>
        <div class="dropdown-content">
            <a href="#">Indicadores</a>
            <a href="#">Setores</a>
            <a href="#">Compara√ß√µes</a>
        </div>
    </div>
    <a href="#">ENTRE EM CONTATO</a>
    <a href="#">FUNDAMENTUS MOBILE</a>
</nav>

<section class="intro">
    <p>
        Fundamentus √© um sistema on-line que disponibiliza informa√ß√µes financeiras e
        fundamentalistas das empresas com a√ß√µes listadas na Bovespa. Possu√≠mos um
        completo banco de dados apresentado de forma acess√≠vel para auxiliar
        o investidor a encontrar as melhores op√ß√µes de investimento.
    </p>

    <img src="https://www.luiztools.com.br/wp-content/uploads/2018/08/dinheiro.jpg" alt="Dinheiro">
</section>

<section id="resultado" class="card hidden">
    <h2>Resultado da An√°lise</h2>

    <div class="card-content">
        <p><strong>Ativo:</strong> <span id="card-symbol"></span></p>

        <hr>

        <p><strong>Pre√ßo Atual:</strong> R$ <span id="card-price"></span></p>
        <p><strong>Pre√ßo Justo:</strong> R$ <span id="card-precojusto"></span></p>

        <hr>

        <p><strong>LPA:</strong> <span id="card-lpa"></span></p>
        <p><strong>VPA:</strong> <span id="card-vpa"></span></p>
        <p><strong>P/L:</strong> <span id="card-pl"></span></p>
        <p><strong>P/VP:</strong> <span id="card-pvp"></span></p>
        <p><strong>Dividend Yield:</strong> <span id="card-dy"></span>%</p>
    </div>
</section>

<section class="features">
    <h2>Funcionalidades</h2>

    <ul>
        <li>üìä Calculo de Pre√ßo Justo de A√ß√µes no Mundo.</li>
        <!--<li>üîç Pesquisa avan√ßada com filtros por PL, PVP, PSR, Dividend Yield, etc.</li>
        <li>üè≠ Compara√ß√£o de empresas por setores e subsetores.</li>
        <li>üìà Visualiza√ß√£o gr√°fica dos indicadores.</li>
        <li>üì• Download dos dados em Excel.</li>-->
    </ul>
</section>

<script>
    document.querySelector("#formBusca").addEventListener("submit", async (e) => {
        e.preventDefault();

        const symbol = document.getElementById("symbolInput").value.trim();
        if (!symbol) return;

        const response = await fetch("/api/preco-justo", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ symbol })
        });

        const data = await response.json();

        // Preencher campos com os dados vindos do MongoDB
        document.getElementById("card-symbol").textContent = data.symbol ?? "-";

        document.getElementById("card-price").textContent = data.fundamentos?.price ?? "-";
        document.getElementById("card-lpa").textContent = data.fundamentos?.lpa ?? "-";
        document.getElementById("card-vpa").textContent = data.fundamentos?.vpa ?? "-";
        document.getElementById("card-pl").textContent = data.fundamentos?.pl ?? "-";
        document.getElementById("card-pvp").textContent = data.fundamentos?.pvp ?? "-";

        document.getElementById("card-dy").textContent =
            data.fundamentos?.dividendYield
                ? (data.fundamentos.dividendYield * 100).toFixed(2)
                : "-";

        document.getElementById("card-precojusto").textContent = data.precoJusto ?? "-";

        // Mostrar o card
        document.getElementById("resultado").classList.remove("hidden");
    });
</script>


</body>
</html>
